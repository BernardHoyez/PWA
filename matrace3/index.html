<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>matrace3</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
  <div id="mode-selector">
    <button id="online-mode" class="active">Mode en ligne</button>
    <button id="offline-mode">Mode hors ligne</button>
  </div>
  <div id="map"></div>
  <div id="controls">
    <button id="start">Commencer l'enregistrement</button>
    <button id="stop">Arrêter l'enregistrement</button>
    <button id="export">Exporter la trace (KML/GPX)</button>
    <button id="preload">Téléchargement préalable</button>
  </div>
  <div id="stats"></div>
  <div id="preload-panel" style="display: none;">
    <div class="panel-header">
      <h3>Téléchargement préalable des tuiles</h3>
      <span id="close-preload-panel" class="close-btn">&times;</span>
    </div>
    <div>
      <label for="preload-lat">Latitude:</label>
      <input type="text" id="preload-lat" placeholder="ex: 46.5">
    </div>
    <div>
      <label for="preload-lon">Longitude:</label>
      <input type="text" id="preload-lon" placeholder="ex: 2.5">
    </div>
    <div>
      <label for="preload-radius">Rayon (km):</label>
      <input type="range" id="preload-radius" min="1" max="10" value="5">
      <span id="preload-radius-value">5</span> km
    </div>
    <button id="preload-confirm">Confirmer</button>
    <button id="preload-cancel">Annuler</button>
    <button id="center-on-user">Centrer sur ma position</button>
    <div id="preload-progress" style="margin-top: 10px; display: none;">
      <progress id="preload-progress-bar" value="0" max="100"></progress>
      <span id="preload-progress-text">0%</span>
    </div>
  </div>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="app.js"></script>
</body>
</html>
