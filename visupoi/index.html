<!doctype html>
<meta name="theme-color" content="#2b6cb0" />
<link rel="manifest" href="manifest.json">


<!-- Leaflet CSS (CDN) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-sA+e2bXg1k0rjv3Y0FQ0u3Vn6N1p3o8Z7+3QmYF8zY4=" crossorigin=""/>
<link rel="stylesheet" href="css/app.css">


</head>
<body>
<header class="topbar">
<div class="title">visupoi</div>
<div class="controls">
<label class="file-label">Charger visit.zip
<input id="zipfile" type="file" accept=".zip" />
</label>
<button id="btn-install" style="display:none">Installer</button>
</div>
</header>


<main>
<div id="map"></div>
</main>


<!-- status / debug -->
<div id="status" class="status"></div>


<!-- Leaflet & JSZip via CDN -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-o9N1j8kzGk6QvYuy6tQkV4bH5p0T8y2Kc0G5H4XvD3s=" crossorigin=""></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js" integrity="" crossorigin="anonymous"></script>


<!-- Application scripts -->
<script src="js/utils.js"></script>
<script src="js/zip-handler.js"></script>
<script src="js/map.js"></script>
<script src="js/app.js"></script>


<!-- Register service worker -->
<script>
if ('serviceWorker' in navigator) {
navigator.serviceWorker.register('service-worker.js').catch(err => console.warn('SW registration failed', err));
}


// simple install prompt handling
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
e.preventDefault();
deferredPrompt = e;
const btn = document.getElementById('btn-install');
btn.style.display = 'inline-block';
btn.onclick = async () => {
btn.style.display = 'none';
deferredPrompt.prompt();
const choice = await deferredPrompt.userChoice;
deferredPrompt = null;
};
});
</script>
</body>
</html>