<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Visite - Extraction médias ZIP</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
  <h1>Chargement des médias depuis un ZIP</h1>
  <input type="file" id="fileInput" accept=".zip" />
  <div id="output"></div>

  <script>
    document.getElementById('fileInput').addEventListener('change', async function(e) {
      const file = e.target.files[0];
      if (!file) return;

      const zip = await JSZip.loadAsync(file);
      const output = document.getElementById('output');
      output.innerHTML = ''; // Vide le contenu précédent

      for (const filename of Object.keys(zip.files)) {
        const zipEntry = zip.files[filename];

        // Gérer uniquement les formats médias supportés
        const isSupportedMedia =
          filename.match(/\.(jpg|jpeg|png|gif|mp4|webm|mp3|wav)$/i);

        if (!isSupportedMedia) {
          continue; // Ignorer les non-médias
        }

        const blob = await zipEntry.async('blob');
        const url = URL.createObjectURL(blob);

        let element;
        if (filename.match(/\.(jpg|jpeg|png|gif)$/i)) {
          element = document.createElement('img');
          element.src = url;
          element.style.maxWidth = '200px';
        } else if (filename.match(/\.(mp4|webm)$/i)) {
          element = document.createElement('video');
          element.src = url;
          element.controls = true;
          element.style.maxWidth = '300px';
        } else if (filename.match(/\.(mp3|wav)$/i)) {
          element = document.createElement('audio');
          element.src = url;
          element.controls = true;
        }

        output.appendChild(element);
        output.appendChild(document.createElement('br'));
      }
    });
  </script>
</body>
</html>
