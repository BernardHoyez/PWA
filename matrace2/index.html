<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>matrace2</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
</head>
<body>
  <div id="mode-selector" style="position: fixed; top: 10px; left: 10px; z-index: 1000; background: white; padding: 10px; border-radius: 5px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);">
    <button id="online-mode">Mode en ligne</button>
    <button id="offline-mode">Mode hors ligne</button>
  </div>
  <div id="map"></div>
  <div id="controls">
    <button id="start">Commencer l'enregistrement</button>
    <button id="stop">Arrêter l'enregistrement</button>
    <button id="export">Exporter la trace (KML/GPX)</button>
    <button id="preload">Téléchargement préalable</button>
  </div>
  <div id="stats"></div>
  <div id="preload-panel" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.2); z-index: 1000;">
    <h3>Téléchargement préalable des tuiles</h3>
    <div>
      <label for="preload-lat">Latitude:</label>
      <input type="text" id="preload-lat" placeholder="ex: 46.5">
    </div>
    <div>
      <label for="preload-lon">Longitude:</label>
      <input type="text" id="preload-lon" placeholder="ex: 2.5">
    </div>
    <div>
      <label for="preload-radius">Rayon (km):</label>
      <input type="range" id="preload-radius" min="1" max="10" value="5">
      <span id="preload-radius-value">5</span> km
    </div>
    <button id="preload-confirm">Confirmer</button>
    <button id="preload-cancel">Annuler</button>
    <button id="center-on-user">Centrer sur ma position</button>
    <div id="preload-progress" style="margin-top: 10px; display: none;">
      <progress id="preload-progress-bar" value="0" max="100" style="width: 100%;"></progress>
      <span id="preload-progress-text">0%</span>
    </div>
  </div>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="app.js"></script>
</body>
</html>
