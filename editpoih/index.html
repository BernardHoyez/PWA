<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#1976d2" />
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" sizes="192x192" href="icons/icon192.png" />
  <link rel="stylesheet" href="css/leaflet.css" />
  <title>editpoih - Editeur de visites</title>
  <style>
    body { font-family: sans-serif; margin:0; background:#f2f2f2;}
    header { background:#1976d2; color:white; padding:1em; text-align:center;}
    .container { display:flex; flex-direction:row; gap:1em; margin:1em;}
    .editor { flex:2; background:white; padding:1em; border-radius:8px;}
    .sidebar { flex:1; background:#fafafa; padding:1em; border-radius:8px;}
    .poi-list { list-style:none; padding:0;}
    .poi-list li { 
      background:#e3e3e3; margin:0.5em 0; padding:0.5em;
      border-radius:6px; cursor:grab; display:flex; justify-content:space-between; align-items:center;
    }
    .file-preview img, .file-preview video { max-width:100px; max-height:80px;}
    #map { height:250px; margin-bottom:1em; }
    .actions { margin-top:1em; }
    input[type="text"], input[type="number"], textarea {
      width:100%; margin:0.25em 0 0.5em 0; padding:0.5em; border-radius:4px; border:1px solid #ccc;
    }
    label { font-weight:bold; }
    button { background:#1976d2; color:white; border:none; border-radius:4px; padding:0.5em 1em; cursor:pointer;}
    button.secondary {background:#aaa;}
    .file-preview audio, .file-preview video { display:block; margin-top:0.5em;}
    .import-section { padding:0.5em; border:1px dashed #bbb; margin-bottom:1em;}
    .import-section input { margin-top:0.5em;}
    @media (max-width:800px) {
      .container {flex-direction:column;}
      .sidebar {margin-top:1em;}
    }
  </style>
</head>
<body>
  <header>
    <h1>editpoih</h1>
    <p>Editeur de visites &mdash; PWA</p>
  </header>
  <div class="container">
    <main class="editor">
      <form id="visit-form">
        <label for="visit-title">Titre de la visite *</label>
        <input type="text" id="visit-title" required placeholder="Nom de la visite">

        <section class="import-section">
          <label for="import-zip">Importer une visite (zip)</label>
          <input type="file" id="import-zip" accept=".zip" />
        </section>
        
        <hr />

        <h2>Ajouter un POI</h2>
        <label for="poi-title">Titre du POI *</label>
        <input type="text" id="poi-title" required placeholder="Titre du POI">

        <label>Localisation (latitude, longitude)*</label>
        <div style="display:flex; gap:0.5em;">
          <input type="number" id="poi-lat" step="any" placeholder="Latitude" required>
          <input type="number" id="poi-lon" step="any" placeholder="Longitude" required>
        </div>
        <div id="map"></div>
        <button type="button" id="get-location">Utiliser la localisation du navigateur</button>
        <br/>

        <label for="poi-comment">Commentaire</label>
        <textarea id="poi-comment" placeholder="Commentaire facultatif"></textarea>

        <div>
          <label>Image JPEG</label>
          <input type="file" id="poi-image" accept="image/jpeg" />
          <div class="file-preview" id="image-preview"></div>
        </div>
        <div>
          <label>Audio MP3</label>
          <input type="file" id="poi-audio" accept="audio/mp3,audio/mpeg" />
          <div class="file-preview" id="audio-preview"></div>
        </div>
        <div>
          <label>Vidéo MP4</label>
          <input type="file" id="poi-video" accept="video/mp4" />
          <div class="file-preview" id="video-preview"></div>
        </div>
        <div class="actions">
          <button type="button" id="add-poi-btn">Ajouter ce POI</button>
        </div>
      </form>
      <div class="actions">
        <button type="button" id="validate-btn">Valider la visite</button>
        <button type="button" id="export-btn">Exporter en .zip</button>
      </div>
    </main>
    <aside class="sidebar">
      <h3>Liste des POI</h3>
      <ul id="poi-list" class="poi-list"></ul>
      <small>Glisser/déposer pour réordonner.<br>Cliquer sur un POI pour modifier ou supprimer.</small>
    </aside>
  </div>
  <script src="js/leaflet.js"></script>
  <script src="js/jszip.min.js"></script>
  <script src="js/exif.js"></script>
  <script src="js/sortable.min.js"></script>
  <script src="service-worker.js"></script>
  <script>
    // Service Worker registration
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js');
      });
    }
  </script>
  <script src="js/main.js"></script>
</body>
</html>