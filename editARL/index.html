<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>editARL - √âditeur de randonn√©es</title>
    <meta name="description" content="√âditeur pour g√©rer les randonn√©es de l'A.R.L.">
    <meta name="theme-color" content="#7c3aed">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link id="manifest-placeholder" rel="manifest" href="data:application/json;charset=utf-8,%7B%22name%22%3A%22editARL%22%2C%22short_name%22%3A%22editARL%22%2C%22start_url%22%3A%22.%2F%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%237c3aed%22%2C%22theme_color%22%3A%22%237c3aed%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22icon-192.png%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image%2Fpng%22%7D%2C%7B%22src%22%3A%22icon-512.png%22%2C%22sizes%22%3A%22512x512%22%2C%22type%22%3A%22image%2Fpng%22%7D%5D%7D">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;
        const { Plus, Download, Copy, FileCode, Trash2, Edit2, FolderDown } = {
            Plus: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>,
            Download: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>,
            Copy: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>,
            FileCode: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>,
            Trash2: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>,
            Edit2: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>,
            FolderDown: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path><polyline points="12 11 12 17"></polyline><polyline points="9 14 12 17 15 14"></polyline></svg>
        };

        function EditARL() {
            const [randonnees, setRandonnees] = useState([
                { nom: "Le Parc de Rouelles", fichier: "rouelles" }
            ]);
            const [nouveauNom, setNouveauNom] = useState('');
            const [nouveauFichier, setNouveauFichier] = useState('');
            const [copiedFile, setCopiedFile] = useState('');
            const [editIndex, setEditIndex] = useState(null);

            const ajouterRandonnee = () => {
                if (!nouveauNom.trim() || !nouveauFichier.trim()) {
                    alert('Veuillez remplir tous les champs');
                    return;
                }

                if (editIndex !== null) {
                    const updated = [...randonnees];
                    updated[editIndex] = { nom: nouveauNom, fichier: nouveauFichier };
                    setRandonnees(updated);
                    setEditIndex(null);
                } else {
                    setRandonnees([...randonnees, { nom: nouveauNom, fichier: nouveauFichier }]);
                }
                
                setNouveauNom('');
                setNouveauFichier('');
            };

            const supprimerRandonnee = (index) => {
                if (confirm('Supprimer cette randonn√©e ?')) {
                    setRandonnees(randonnees.filter((_, i) => i !== index));
                }
            };

            const modifierRandonnee = (index) => {
                setNouveauNom(randonnees[index].nom);
                setNouveauFichier(randonnees[index].fichier);
                setEditIndex(index);
            };

            const annulerModification = () => {
                setNouveauNom('');
                setNouveauFichier('');
                setEditIndex(null);
            };

            const genererIndexHTML = () => {
                return `<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Randonner avec l'A.R.L.</title>
    <meta name="description" content="D√©couvrez les randonn√©es de l'Association Randonn√©e Loisirs">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .randonnees-list {
            display: grid;
            gap: 20px;
        }
        
        .randonnee-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .randonnee-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }
        
        .randonnee-card h2 {
            color: #667eea;
            font-size: 1.5em;
            margin-bottom: 15px;
        }
        
        .btn-voir {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: transform 0.2s ease;
        }
        
        .btn-voir:hover {
            transform: scale(1.05);
        }
        
        footer {
            text-align: center;
            color: white;
            margin-top: 50px;
            opacity: 0.8;
        }
        
        @media (max-width: 600px) {
            h1 {
                font-size: 2em;
            }
            
            .randonnee-card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü•æ Randonner avec l'A.R.L.</h1>
            <p class="subtitle">Nos parcours de randonn√©e</p>
        </header>
        
        <div class="randonnees-list">
${randonnees.map(r => `            <div class="randonnee-card">
                <h2>${r.nom}</h2>
                <a href="https://BernardHoyez.github.io/PWA/ARL/${r.fichier}.html" target="_blank" rel="noopener noreferrer" class="btn-voir">Voir la carte üó∫Ô∏è</a>
            </div>`).join('\n')}
        </div>
        
        <footer>
            <p>Association Randonn√©e Loisirs &copy; ${new Date().getFullYear()}</p>
        </footer>
    </div>
</body>
</html>`;
            };

            const telechargerFichier = (contenu, nomFichier) => {
                const blob = new Blob([contenu], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = nomFichier;
                a.click();
                URL.revokeObjectURL(url);
            };

            const copierContenu = (contenu, nomFichier) => {
                navigator.clipboard.writeText(contenu).then(() => {
                    setCopiedFile(nomFichier);
                    setTimeout(() => setCopiedFile(''), 2000);
                });
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-600 to-indigo-700 p-4">
                    <div className="max-w-4xl mx-auto">
                        <header className="text-center text-white mb-8">
                            <h1 className="text-4xl font-bold mb-2">üìù editARL</h1>
                            <p className="text-lg opacity-90">√âditeur de randonn√©es pour A.R.L.</p>
                        </header>

                        <div className="bg-white rounded-xl shadow-2xl p-6 mb-6">
                            <h2 className="text-2xl font-bold mb-4 text-purple-700">
                                {editIndex !== null ? '‚úèÔ∏è Modifier' : '‚ûï Ajouter'} une randonn√©e
                            </h2>
                            
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Nom de la randonn√©e
                                    </label>
                                    <input
                                        type="text"
                                        value={nouveauNom}
                                        onChange={(e) => setNouveauNom(e.target.value)}
                                        placeholder="Ex: Le Parc de Rouelles"
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Nom du fichier (sans .html)
                                    </label>
                                    <input
                                        type="text"
                                        value={nouveauFichier}
                                        onChange={(e) => setNouveauFichier(e.target.value)}
                                        placeholder="Ex: saint-jouin"
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    />
                                    <p className="text-xs text-gray-500 mt-1">
                                        URL g√©n√©r√©e : https://BernardHoyez.github.io/PWA/ARL/{nouveauFichier || 'votre-fichier'}.html
                                    </p>
                                </div>
                                
                                <div className="flex gap-3">
                                    <button
                                        onClick={ajouterRandonnee}
                                        className="flex-1 bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-indigo-700 transition flex items-center justify-center gap-2"
                                    >
                                        {editIndex !== null ? <Edit2 /> : <Plus />}
                                        {editIndex !== null ? 'Modifier' : 'Ajouter'}
                                    </button>
                                    
                                    {editIndex !== null && (
                                        <button
                                            onClick={annulerModification}
                                            className="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-400 transition"
                                        >
                                            Annuler
                                        </button>
                                    )}
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-xl shadow-2xl p-6 mb-6">
                            <h2 className="text-2xl font-bold mb-4 text-purple-700">üìã Liste des randonn√©es</h2>
                            
                            {randonnees.length === 0 ? (
                                <p className="text-gray-500 text-center py-8">Aucune randonn√©e ajout√©e</p>
                            ) : (
                                <div className="space-y-3">
                                    {randonnees.map((rando, index) => (
                                        <div key={index} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                                            <div className="flex-1">
                                                <h3 className="font-semibold text-lg text-gray-800">{rando.nom}</h3>
                                                <p className="text-sm text-gray-500">{rando.fichier}.html</p>
                                            </div>
                                            <div className="flex gap-2">
                                                <button
                                                    onClick={() => modifierRandonnee(index)}
                                                    className="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition"
                                                    title="Modifier"
                                                >
                                                    <Edit2 />
                                                </button>
                                                <button
                                                    onClick={() => supprimerRandonnee(index)}
                                                    className="p-2 text-red-600 hover:bg-red-50 rounded-lg transition"
                                                    title="Supprimer"
                                                >
                                                    <Trash2 />
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        <div className="bg-white rounded-xl shadow-2xl p-6 mb-6">
                            <h2 className="text-2xl font-bold mb-4 text-purple-700">üíæ Exporter index.html pour ARL</h2>
                            
                            <div className="flex gap-3 mb-4">
                                <button
                                    onClick={() => telechargerFichier(genererIndexHTML(), 'index.html')}
                                    className="flex-1 bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition flex items-center justify-center gap-2"
                                >
                                    <Download />
                                    T√©l√©charger index.html
                                </button>
                                
                                <button
                                    onClick={() => copierContenu(genererIndexHTML(), 'index.html')}
                                    className="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition flex items-center justify-center gap-2"
                                >
                                    {copiedFile === 'index.html' ? '‚úì Copi√© !' : <><Copy /> Copier</>}
                                </button>
                            </div>
                            
                            <div className="p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded">
                                <p className="text-sm text-yellow-800">
                                    <strong>üìå Instructions :</strong> T√©l√©chargez ou copiez le code, puis remplacez le fichier index.html dans votre d√©p√¥t GitHub <code className="bg-yellow-100 px-2 py-1 rounded">PWA/ARL/</code>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<EditARL />, document.getElementById('root'));
    </script>
    
    <script>
        // Service Worker inline
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const swCode = `
                    const CACHE_NAME = 'editarl-v1';
                    const urlsToCache = [
                        './',
                        './index.html',
                        'https://unpkg.com/react@18/umd/react.production.min.js',
                        'https://unpkg.com/react-dom@18/umd/react-dom.production.min.js',
                        'https://unpkg.com/@babel/standalone/babel.min.js',
                        'https://cdn.tailwindcss.com'
                    ];

                    self.addEventListener('install', event => {
                        event.waitUntil(
                            caches.open(CACHE_NAME).then(cache => {
                                return Promise.allSettled(
                                    urlsToCache.map(url => 
                                        cache.add(url).catch(err => console.log('Cache error:', url))
                                    )
                                );
                            })
                        );
                    });

                    self.addEventListener('activate', event => {
                        event.waitUntil(
                            caches.keys().then(cacheNames => {
                                return Promise.all(
                                    cacheNames.map(cacheName => {
                                        if (cacheName !== CACHE_NAME) {
                                            return caches.delete(cacheName);
                                        }
                                    })
                                );
                            })
                        );
                    });

                    self.addEventListener('fetch', event => {
                        event.respondWith(
                            fetch(event.request)
                                .then(response => {
                                    if (response && response.status === 200) {
                                        const responseClone = response.clone();
                                        caches.open(CACHE_NAME).then(cache => {
                                            cache.put(event.request, responseClone);
                                        });
                                    }
                                    return response;
                                })
                                .catch(() => caches.match(event.request))
                        );
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl)
                    .then(reg => console.log('Service Worker enregistr√©'))
                    .catch(err => console.log('Erreur Service Worker:', err));
            });
        }
    </script>
</body>
</html>